name: modal-prefect-simplest
prefect-version: 3.4.1

build: null
push: null
pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /opt/prefect/app

deployments:
  - name: subflow
    version: null
    tags: []
    concurrency_limit: null
    description: This one runs on Modal
    entrypoint: main.py:flow_sees_subflow
    parameters: {}
    work_pool:
      name: modal-pool
      work_queue_name: null
      job_variables:
        image:
          name: "ghcr.io/loamincom/modal-prefect-simplest:latest" # override the container image
        image_pull_policy: "IF_NOT_PRESENT" # must be one of 'ALWAYS','NEVER','IF_NOT_PRESENT'  [oai_citation:0‡docs-2.prefect.io](https://docs-2.prefect.io/latest/concepts/infrastructure/)
        env:
          GHCR_PAT: "{{ prefect.blocks.secret.ghcr-pat }}"
    schedules: []

  - name: main_flow
    version: null
    tags: []
    concurrency_limit: null
    description: This one runs on Modal and hopefully calls another `@flow`
    entrypoint: main.py:flow_sees_flow
    parameters: {}
    work_pool:
      name: modal-pool
      work_queue_name: null
      job_variables:
        image:
          name: "ghcr.io/loamincom/modal-prefect-simplest:latest" # override the container image
        image_pull_policy: "IF_NOT_PRESENT" # must be one of 'ALWAYS','NEVER','IF_NOT_PRESENT'  [oai_citation:0‡docs-2.prefect.io](https://docs-2.prefect.io/latest/concepts/infrastructure/)
        env:
          GHCR_PAT: "{{ prefect.blocks.secret.ghcr-pat }}"
    schedules: []
